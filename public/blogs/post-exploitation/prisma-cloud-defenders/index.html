<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Prisma Cloud Defenders | Script Adults</title>
<meta name="keywords" content="prisma cloud, lateral movement">
<meta name="description" content="Tl;dr - unfixed information disclosure in Prisma Cloud defenders This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.
Introduction A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent).">
<meta name="author" content="">
<link rel="canonical" href="https://katsuragicsl.github.io/blogs/post-exploitation/prisma-cloud-defenders/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://katsuragicsl.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://katsuragicsl.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://katsuragicsl.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://katsuragicsl.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://katsuragicsl.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://katsuragicsl.github.io/blogs/post-exploitation/prisma-cloud-defenders/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  

<meta property="og:title" content="Prisma Cloud Defenders" />
<meta property="og:description" content="Tl;dr - unfixed information disclosure in Prisma Cloud defenders This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.
Introduction A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://katsuragicsl.github.io/blogs/post-exploitation/prisma-cloud-defenders/" />
<meta property="og:image" content="https://katsuragicsl.github.io/images/papermod-cover.png" />
<meta property="article:section" content="blogs" />
<meta property="article:published_time" content="2022-07-20T17:54:24+08:00" />
<meta property="article:modified_time" content="2022-08-03T22:14:05+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://katsuragicsl.github.io/images/papermod-cover.png" />
<meta name="twitter:title" content="Prisma Cloud Defenders"/>
<meta name="twitter:description" content="Tl;dr - unfixed information disclosure in Prisma Cloud defenders This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.
Introduction A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent)."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "https://katsuragicsl.github.io/blogs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Prisma Cloud Defenders",
      "item": "https://katsuragicsl.github.io/blogs/post-exploitation/prisma-cloud-defenders/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Prisma Cloud Defenders",
  "name": "Prisma Cloud Defenders",
  "description": "Tl;dr - unfixed information disclosure in Prisma Cloud defenders This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.\nIntroduction A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent).",
  "keywords": [
    "prisma cloud", "lateral movement"
  ],
  "articleBody": "Tl;dr - unfixed information disclosure in Prisma Cloud defenders This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.\nIntroduction A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent). This issue has been reported to Palo Alto as security disclosure, however Palo Alto declared that this is an expected behavior.\nWhile Palo Alto seems not considering it as a problem, I think it is at least a trick for post exploitation. Below is some background knowledge.\nPrisma Cloud Prisma Cloud is a cloud security solution developed by Palo Alto, providing features including monitoring processes in standalone hosts/ run as daemon set in a K8S cluster.\nThis is done by deploying an agent (which is called a defender) in the target host.\nTo do so, one needs permissions to Prisma Cloud in order to get an access token. Defender Manager is the most suitable role for an operator whose manager only wants him to help deploying defenders without letting him/ her know other information, for example monitoring rules.\nDigging the hole host Let’s get a Defender Manager role and install a host defender on a linux machine, let’s say machine A.\nTake a look at the directory /var/lib/twistlock/local_db/local//messages/, connect is a big file containing a lot of configs, while some details are stored in other files in the same directory.\nWhy can I view things that has nothing to do with my host? Other assets like container registries /var/lib/twistlock/local_db/local//connect\nFirewall rules that belongs to OTHER hosts /var/lib/twistlock/local_db/local//hostAppFirewallPolicy\nContent of custom rules (e.g. process/ network monitoring) /var/lib/twistlock/local_db/local//updateCustomRule\nAs a Defender Manager, all you are supposed to have is the root access in the host where the defender to be installed on. However, after installing defenders, you will be able to get information much more than just the info of that host. For example, reading custom rules on other hosts, let say, hosts which are more important and you don’t want to get caught when you have the chance to access them.\nThose could help you if you are an internal threat of a company which uses Prisma Cloud but don’t know this trick :)\n",
  "wordCount" : "403",
  "inLanguage": "en",
  "image": "https://katsuragicsl.github.io/images/papermod-cover.png","datePublished": "2022-07-20T17:54:24+08:00",
  "dateModified": "2022-08-03T22:14:05+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://katsuragicsl.github.io/blogs/post-exploitation/prisma-cloud-defenders/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Script Adults",
    "logo": {
      "@type": "ImageObject",
      "url": "https://katsuragicsl.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://katsuragicsl.github.io/" accesskey="h" title="Script Adults (Alt + H)">Script Adults</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://katsuragicsl.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://katsuragicsl.github.io/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://katsuragicsl.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://katsuragicsl.github.io/search/" title="Searach (Alt &#43; /)" accesskey=/>
                    <span>Searach</span>
                </a>
            </li>
            <li>
                <a href="https://katsuragicsl.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://katsuragicsl.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://katsuragicsl.github.io/blogs/">Blogs</a></div>
    <h1 class="post-title entry-hint-parent">
      Prisma Cloud Defenders
    </h1>
    <div class="post-meta"><span title='2022-07-20 17:54:24 +0800 CST'>July 20, 2022</span>&nbsp;·&nbsp;2 min

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#tldr---unfixed-information-disclosure-in-prisma-cloud-defenders" aria-label="Tl;dr - unfixed information disclosure in Prisma Cloud defenders">Tl;dr - unfixed information disclosure in Prisma Cloud defenders</a></li>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#prisma-cloud" aria-label="Prisma Cloud">Prisma Cloud</a></li>
                <li>
                    <a href="#digging-the--hole--host" aria-label="Digging the hole host">Digging the hole host</a></li>
                <li>
                    <a href="#why-can-i-view-things-that-has-nothing-to-do-with-my-host" aria-label="Why can I view things that has nothing to do with my host?">Why can I view things that has nothing to do with my host?</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="tldr---unfixed-information-disclosure-in-prisma-cloud-defenders">Tl;dr - unfixed information disclosure in Prisma Cloud defenders<a hidden class="anchor" aria-hidden="true" href="#tldr---unfixed-information-disclosure-in-prisma-cloud-defenders">#</a></h2>
<p>This post is about how to abuse a agent of a cloud security solution to get information which you should not know, like what security controls are applied, what assets the victim owns and the owners of the assets.</p>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>A few months ago I was examining the Prisma Cloud configuration of my workplace and accidentally discovered an information disclosure issue of Prisma Cloud defender (the agent). This issue has been reported to Palo Alto as security disclosure, however Palo Alto declared that this is an <a href="https://github.com/PaloAltoNetworks/prisma-cloud-docs/pull/400/commits/3f6d17e63170929a2be5f015a28034fd80631486">expected behavior</a>.</p>
<p><img loading="lazy" src="/prisma-cloud-defenders/prisma1.png" alt=""  />
</p>
<p>While Palo Alto seems not considering it as a problem, I think it is at least a trick for post exploitation. Below is some background knowledge.</p>
<h2 id="prisma-cloud">Prisma Cloud<a hidden class="anchor" aria-hidden="true" href="#prisma-cloud">#</a></h2>
<p>Prisma Cloud is a cloud security solution developed by Palo Alto, providing features including monitoring processes in standalone hosts/ run as daemon set in a K8S cluster.</p>
<p>This is done by deploying an agent (which is called a <strong>defender</strong>) in the target host.</p>
<p>To do so, one needs permissions to Prisma Cloud in order to get an access token. <strong>Defender Manager</strong> is the most suitable role for an operator whose manager only wants him to help deploying defenders without letting him/ her know other information, for example monitoring rules.</p>
<p><img loading="lazy" src="/prisma-cloud-defenders/prisma2.png" alt=""  />
</p>
<h2 id="digging-the--hole--host">Digging the  <del>hole</del>  host<a hidden class="anchor" aria-hidden="true" href="#digging-the--hole--host">#</a></h2>
<p>Let&rsquo;s get a <strong>Defender Manager</strong> role and install a host defender on a linux machine, let&rsquo;s say machine A.<br>
Take a look at the directory <code>/var/lib/twistlock/local_db/local/&lt;version number&gt;/messages/</code>, <code>connect</code> is a big file containing a lot of configs, while some details are stored in other files in the same directory.</p>
<p><img loading="lazy" src="/prisma-cloud-defenders/message_dir.png" alt=""  />
</p>
<h2 id="why-can-i-view-things-that-has-nothing-to-do-with-my-host">Why can I view things that has nothing to do with my host?<a hidden class="anchor" aria-hidden="true" href="#why-can-i-view-things-that-has-nothing-to-do-with-my-host">#</a></h2>
<ul>
<li>Other assets like container registries</li>
</ul>
<p><code>/var/lib/twistlock/local_db/local/&lt;version number&gt;/connect</code></p>
<p><img loading="lazy" src="/prisma-cloud-defenders/assets.png" alt=""  />
</p>
<ul>
<li>Firewall rules that belongs to <strong>OTHER</strong> hosts</li>
</ul>
<p><code>/var/lib/twistlock/local_db/local/&lt;version number&gt;/hostAppFirewallPolicy</code></p>
<p><img loading="lazy" src="/prisma-cloud-defenders/hostappfirewallrule.png" alt=""  />
</p>
<ul>
<li>Content of custom rules (e.g. process/ network monitoring)</li>
</ul>
<p><code>/var/lib/twistlock/local_db/local/&lt;version number&gt;/updateCustomRule</code></p>
<p><img loading="lazy" src="/prisma-cloud-defenders/custom_rule_content.png" alt=""  />
</p>
<p>As a <strong>Defender Manager</strong>, all you are supposed to have is the root access in the host where the defender to be installed on. However, after installing defenders, you will be able to get information much more than just the info of that host. For example, reading custom rules on other hosts, let say, hosts which are more important and you don&rsquo;t want to get caught when you have the chance to access them.</p>
<p>Those could help you if you are an internal threat of a company which uses Prisma Cloud but don&rsquo;t know this trick :)</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://katsuragicsl.github.io/tags/prisma-cloud/">Prisma Cloud</a></li>
      <li><a href="https://katsuragicsl.github.io/tags/lateral-movement/">Lateral Movement</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://katsuragicsl.github.io/blogs/post-exploitation/lots-project-paypal/">
    <span class="title">« Prev</span>
    <br>
    <span>LOTS Project - Paypal</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Prisma Cloud Defenders on x"
            href="https://x.com/intent/tweet/?text=Prisma%20Cloud%20Defenders&amp;url=https%3a%2f%2fkatsuragicsl.github.io%2fblogs%2fpost-exploitation%2fprisma-cloud-defenders%2f&amp;hashtags=prismacloud%2clateralmovement">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Prisma Cloud Defenders on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fkatsuragicsl.github.io%2fblogs%2fpost-exploitation%2fprisma-cloud-defenders%2f&amp;title=Prisma%20Cloud%20Defenders&amp;summary=Prisma%20Cloud%20Defenders&amp;source=https%3a%2f%2fkatsuragicsl.github.io%2fblogs%2fpost-exploitation%2fprisma-cloud-defenders%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Prisma Cloud Defenders on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fkatsuragicsl.github.io%2fblogs%2fpost-exploitation%2fprisma-cloud-defenders%2f&title=Prisma%20Cloud%20Defenders">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Prisma Cloud Defenders on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Prisma%20Cloud%20Defenders&u=https%3a%2f%2fkatsuragicsl.github.io%2fblogs%2fpost-exploitation%2fprisma-cloud-defenders%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

    <script src="https://utteranc.es/client.js"
            label="comment"
            repo="KatsuragiCSL/katsuragicsl.github.io"
            issue-term="title"
            theme="photon-dark"
            crossorigin="anonymous"
            async>
    </script>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://katsuragicsl.github.io/">Script Adults</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
